---
title: "Climate_Data_Group_3"
author: "Sasha Marquez, Audrey Decker, Rona Kobell, Jeremy Tombs, Rayonna Burton"
date: "11/9/2020"
output:
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}

library(tidyverse)
library(vembedr)
library(lubridate)
library(janitor)

```

```{r}

national_year <- read.csv("https://raw.githubusercontent.com/washingtonpost/data-2C-beyond-the-limit-usa/main/data/processed/climdiv_national_year.csv")
county_year <- read.csv("https://raw.githubusercontent.com/washingtonpost/data-2C-beyond-the-limit-usa/main/data/processed/climdiv_county_year.csv")
state_year <- read.csv("https://raw.githubusercontent.com/washingtonpost/data-2C-beyond-the-limit-usa/main/data/processed/climdiv_state_year.csv")
model_county <- read.csv("https://raw.githubusercontent.com/washingtonpost/data-2C-beyond-the-limit-usa/main/data/processed/model_county.csv")
model_state <- read.csv("https://raw.githubusercontent.com/washingtonpost/data-2C-beyond-the-limit-usa/main/data/processed/model_state.csv")
drought_data <- read_csv("data/north_dakota_drought_severity_data - Sheet1.csv")

options(scipen=999)

```


```{r}
#Create new data frame called model_state_ND_only
model_state_ND_only <- model_state %>%
#Filter just for the row of North Dakota data  
  filter (fips == 38) 

```

##Background: Why we selected North Dakota
```{r}
#Create new data frame called model_state_sorted
model_state_sorted <- model_state %>%
#Sort the model_state sheet in descending order by annual average temperature change  
  arrange (desc(Annual))

#North Dakota is the state in the U.S. with the seventh largest rate of annual average temperature change. Each of the states with larger change are confined to one region: New England and the mid-Atlantic. North Dakota stands out as the first state on the list not in that region, but rather much closer to the Pacific coast. Some questions emerge: how does the high rate of temperature change affect crops grown in the state? How does the high rate of temperature change affect the growing season for agriculture in the state? Are there any correlated phenomena (ie. drought, rainfall, weather conditions, etc) that can be observed as a result of the high rate of temperature change? Why is the average annual temperature change in North Dakota more comparable to states in New England rather than other states around North Dakota?
```

```{r}
#Create new data frame called model_county_ND_sorted from the model_county data frame
model_county_ND_sorted <- model_county %>%
#Filter for just North Dakota  
  filter (STNAME == "North Dakota") %>%
#Arrange in descending order by annual average temperature change.  
  arrange (desc(Annual))

#This dataframe arranges counties in North Dakota in descending order by average annual temperature change. The top five counties listed are all in the northernmost part of the state, which poses some questions about what the agriculture is like there, what the terrain is like, what the population and industry is like, and how these are all affected by rising temperatures. Additionally, all top 5 counties have had average annual temperature increases of at least .31 degrees higher than the state average.

```


##Finding 1: Looking at any correlation between increased severe drought areas in North Dakota and increased temperatures in the state.
```{r}
#Create new data frame called drought_data_year_filtered from the original drought_data data frame. 
drought_data_year_filtered <- drought_data %>%
#Using the lubridate package, create a new column called "year." Fill that column with the years from the dates in the "Week" column.  
  mutate(year = year(Week))

```

```{r}
#Create new data frame called ND_only_state_year from the state_year data frame.
ND_only_state_year <- state_year %>%
#Filter for just the North Dakota FIPS code, 38. This creates the same data frame as state_year but includes only the rows pertaining to North Dakota.  
   filter (fips == "38")
```

```{r}
#Create new data frame called yearly_drought_average from the drought_data_year_filtered data frame,
yearly_drought_average <- drought_data_year_filtered %>%
#Clean the column names using the janitor package to remove any dashes and capital letters.  
  clean_names() %>%
#Group the rows by the values in the year column.  
  group_by(year) %>%
#For each drought severity column, find the mean of all the values of the weeks in that year. This way, when there's only one row per year, there will be an average of all 52 weeks' data in the row for the year.
  summarise(none=mean(none),
            d0=mean(d0_d4),
            d1=mean(d1_d4),
            d2=mean(d2_d4),
            d3=mean(d3_d4),
            d4=mean(d4))
```

```{r}
#Create new data frame called yearly_avg_temps_drought from the yearly_drought_average data frame.
yearly_avg_temps_drought <- yearly_drought_average %>%
#Join the ND_only_state_year data frame with the yearly_drought_average data frame. This will combine the two based on the column they have in common, year. It also eliminates any rows of years that are not common between the two data frames. This was important for ND_only_state_year, because the data frame listed every year from 1895, for which we did not have drought data for.
  inner_join(ND_only_state_year)
```

```{r}
#This is just testing out how to graphically represent the data for this finding. 
yearly_avg_temps_drought %>%
  ggplot(aes(year, d0)) +
  geom_bar(stat="identity",
           fill="steelblue",) +
      labs(
       x="Year",
       y="Percentage of the state in drought",
       title="test",
           caption="Source: Drought Data"
           ) +
          geom_text(aes(label=round(2))
                    ,
                    vjust=-.1)
```

```{r}
#This is just testing out how to graphically represent the data for this finding. 
yearly_avg_temps_drought %>%
  ggplot(aes(year, temp)) +
  geom_bar(stat="identity",
           fill="steelblue",) +
      labs(
       x="Year",
       y="Percentage of the state in drought",
       title="test",
           caption="Source: Drought Data"
           ) +
          geom_text(aes(label=round(2))
                    ,
                    vjust=-.1)

```

##Finding 2: Rising temperatures in North Dakota have extended their growing season.
##Finding 3: Climate change's effect on Native American reservations in North Dakota
##Finding 4: 